---
title: Googleアナリティクスの設置
date: 2020-04-08 10:43:24
tags:
  - Hexo
---

ブログサイトにGoogleアナリティクスを設置する。前提として、Googleアナリティクスのコンソールを利用できる状態とする。

1. プロパティを作成する。
1. 作成したプロパティのビューを設定する。
1. プロパティからトラッキングIDを取得して、テーマの_config.ymlのgoogle_analyticsに設定する。

## プロパティの作成

1. [Googleアナリティクスのコンソール](http://www.google.co.jp/analytics/)をwebブラウザで開く。

1. 適当なアカウントにプロパティを作成する。

    1. 「+プロパティを作成」ボタンをクリックして、プロパティの作成画面を開く。

    1. プロパティの作成画面で、測定の対象としてウェブを選択して、画面の下にある「続行」ボタンをクリックする。

    1. プロパティの設定画面でウェブサイトの名前とURL、業種を入力する。タイムゾーンは日本を選ぶと自動的に日本時間が選択される。

    1. 作成ボタンをクリックして、プロパティを作成する。

## ビューの設定

自分のアクセスを除外するため、フィルタに自分のIPアドレスを登録する。

1. 自動的に作成される「すべてのウェブサイトのデータ」ビューの、フィルタの設定画面を開く。

1. 「+フィルタを追加」ボタンをクリックして、ビューにフィルタを追加画面を開く。

1. 他のプロパティで作成したフィルタを利用する場合には、既存のフィルタを適用を選択して、表示された使用可能なフィルタから、適用するフィルタを選択したフィルタに追加して、保存ボタンをクリックする。

1. 新しいフィルタを作成する

    1. フィルタ名を適当な名前を入力する。

    1. フィルタの種類に除外を選択する。

    1. 参照元かリンク先を選択から、IPアドレスからのトラフィックを選択する。

    1. IPアドレスに自分のグローバルIPアドレスを入力する。

    1. 式を選択から、等しいを選択する。

    1. 保存ボタンをクリックして、フィルタを作成する。

## トラッキングIDの取得と設定

1. 作成したプロパティの「トラッキング情報」から「トラッキングコード」画面を開くと、トラッキングIDが表示される。

1. テーマの設定ファイル、デフォルトのテーマはlandscapeなので、themes/landscape/_config.ymlのgoogle_analyticsに取得したトラッキングIDを設定する。トラッキングIDはシングルクォートで囲まないと、Hexoをbuildするときに`Unhandled rejection TypeError: Cannot convert undefined or null to object`というエラーが発生する。
